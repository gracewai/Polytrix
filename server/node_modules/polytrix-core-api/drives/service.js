//
//	Service.js
//	This is the standard class and wrapper for all drive services
//

// auth
//	authUrl()
//	getToken(code)
//	renewToken(refresh_token)

// info
//	accountInfo(access_token,refresh_token)
//	usageQouta(access_token,refresh_token)

// metadata
//	get(access_token,refresh_token,fileId)
//	listFile(access_token,refresh_token,fileId)
//	downloadUrl(access_token,refresh_token,fileId)

// operation
//	create(access_token,refresh_token,destinationFileId,is_folder,filename)
//	rename(access_token,refersh_token,fileId,newName)
//	move(access_token,refresh_token,fileId,destinationFileId,fileId)
//	copy(access_token,refresh_token,fileId,destinationFileId)
//	delete(access_token,refresh_token,fileId)

// stream
//	createAndUploadStream(access_token,refresh_token,destinationFileId,readStream,mimeType,filename)
//	uploadStream(access_token,refresh_token,fileId,readStream,mimeType,overwrite,parent_rev)
//	downloadStream(access_token,refresh_token,fileId)

// share
//	list(access_token,refresh_token,fileId)
//	get(access_token,refresh_token,fileId,shareId)
//	new(access_token,refresh_token,fileId,type,role,value)
//	update(access_token,refresh_token,fileId,shareId,type,role,value)
//	remove(access_token,refresh_token,fileId,shareId)
var Client = require('./client');


var Service = function(serviceProvider){
	this.provider = serviceProvider;
	this.auth = new Auth(serviceProvider);
	this.info = new Info(serviceProvider);
	this.metadata = new Metadata(serviceProvider);
	this.operation = new Operation(serviceProvider);
	this.stream = new Stream(serviceProvider);
	this.share = new Share(serviceProvider);
	this.rootIdentifier = this.provider.rootIdentifier;
};

// auth
var Auth = function(provider){this.provider = provider;};
Auth.prototype = {
	authUrl: function(){
		return this.provider.auth.authUrl();
	},

	getToken: function(code){
		return this.provider.auth.getToken(code);
	},

	renewToken: function(refresh_token){
		return this.provider.auth.renewToken(refresh_token);
	},
};



// info
var Info = function(provider){this.provider = provider;};
Info.prototype = {
	accountInfo: function(access_token,refresh_token){
		return this.provider.info.accountInfo(access_token,refresh_token);
	},

	usageQouta: function(access_token,refresh_token){
		return this.provider.info.usageQouta(access_token,refresh_token);
	},
};


// metadata
var Metadata = function(provider){this.provider = provider;};
Metadata.prototype = {
	get: function(access_token,refresh_token,fileId){
		fileId = fileId || this.provider.rootIdentifier;
		return this.provider.metadata.get(access_token,refresh_token,fileId);
	},

	listFile: function(access_token,refresh_token,fileId){
		fileId = fileId || this.provider.rootIdentifier;
		return this.provider.metadata.listFile(access_token,refresh_token,fileId);
	},

	downloadUrl: function(access_token,refresh_token,fileId){
		return this.provider.metadata.downloadUrl(access_token,refresh_token,fileId);
	},
};


// operation
var Operation = function(provider){this.provider = provider;};
Operation.prototype = {
	create: function(access_token,refresh_token,destinationFileId,is_folder,filename){
		return this.provider.operation.create(access_token,refresh_token,destinationFileId,is_folder,filename);
	},

	rename: function(access_token,refresh_token,fileId,newName){
		return this.provider.operation.rename(access_token,refresh_token,fileId,newName);
	},

	move: function(access_token,refresh_token,fileId,destinationFileId){
		return this.provider.operation.move(access_token,refresh_token,fileId,destinationFileId);
	},

	copy: function(access_token,refresh_token,fileId,destinationFileId){
		return this.provider.operation.copy(access_token,refresh_token,fileId,destinationFileId);
	},

	delete: function(access_token,refresh_token,fileId){
		return this.provider.operation.delete(access_token,refresh_token,fileId);
	},
};


// stream
var Stream = function(provider){this.provider = provider;};
Stream.prototype = {
	createAndUploadStream: function(access_token,refresh_token,destinationFileId,readStream,mimeType,filename){
		return this.provider.stream.createAndUploadStream(access_token,refresh_token,destinationFileId,readStream,mimeType,filename);
	},

	uploadStream: function(access_token,refresh_token,fileId,readStream,mimeType,overwrite,parent_rev){
		return this.provider.stream.uploadStream(access_token,refresh_token,fileId,readStream,mimeType,overwrite,parent_rev);
	},

	downloadStream: function(access_token,refresh_token,fileId){
		return this.provider.stream.downloadStream(access_token,refresh_token,fileId);
	},
};


// share
var Share = function(provider){this.provider = provider;};
Share.prototype = {
	list: function(access_token,refresh_token,fileId){
		return this.provider.share.list(access_token,refresh_token,fileId);
	},

	get: function(access_token,refresh_token,fileId,shareId){
		return this.provider.share.get(access_token,refresh_token,fileId,shareId);
	},

	new: function(access_token,refresh_token,fileId,type,role,value){
		return this.provider.share.new(access_token,refresh_token,fileId,type,role,value);
	},

	update: function(access_token,refresh_token,fileId,type,role,value){
		return this.provider.share.update(access_token,refresh_token,fileId,type,role,value);
	},

	remove: function(access_token,refresh_token,fileId,shareId){
		return this.provider.share.remove(access_token,refresh_token,fileId,shareId);
	},
};

Service.prototype.client = function(access_token,refresh_token){
	return new Client(this,access_token,refresh_token);
};

module.exports = Service;