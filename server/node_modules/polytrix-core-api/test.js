var services = require('./main');
var Q = require('q');
var should = require('should');

var
	dropbox = services.dropbox.client(
		/*access_token:*/ 'r2YJWpOcVrcAAAAAAAABqolIXozKMwwGuKxHd_3y7pxWIfmjySfDLWC60Hvx99UZ',
		/*refresh_token:*/ null
		),
	googledrive = services.googledrive.client(
		/*access_token:*/ 'ya29.GwHFNZrmrfE7jbaec8nI5sOQEyxp_MmgPjCPtA15uvAXiqIzegr1Nbb3cRolyfUTKsD0oavQpj6eww',
		/*refresh_token:*/ '1/2c_pwihU1zEibKmM88Gecdzr76liR49ly58NG4ALDnV90RDknAdJa_sgfheVM0XT'
		),
	onedrive = services.onedrive.client(
		/*access_token:*/ 'EwBwAq1DBAAUGCCXc8wU/zFu9QnLdZXy+YnElFkAAZtpHjlRhESazMRXKsH0s3T1pO9oWLVyzvgGQVRZ336GN07Sdue4n5fdV+kCmGbG6Z8b+U+tNsNiYs/UB1oiaXU24tNSOroEt5t0qHjFrQ9IUPUrnuHNBq0pviJyA9iVbgZVR+2v3Ql82gFKo3lGkq4EardyL+h+UD/jyc1GrWN+SiKPtLPMQLkL1ZZbuXZF9P5sYQ+ugww4XTSJb56DQVPpnZCx5wughePS6rsxWqaGK/YcQolFvEBJUWdOvgETzegfyABif9ydc2HAm8ySNZ71AqVRMa5l5xfYfxWU0nWAIwO/0DUWAV/1GGC42PmVDCamVmPmUcz8u5i44mT8MyADZgAACJPLJTts82lsQAEVLVLAW3DrbJEHdOVaCPQ61GwaY5D6A0J0lScTckztkx7qtxF+29YPyV82nVV25iNre/UpCMHtoUy7tglL0hGVyKQ4qfjx29SkrU4hYBLuFvZIBrTJ6CmGeOzw/kibfCcNOEIRVpCaM8CFy86rSJPVuKK7IStUtz5qee+U+v1498eSh/3fE0XDp4klNo8Jiowqf+hnpPQ8qNeaOceRJlcIaviFGfVMqjPEpgX6MRp/uHNOsq/YZw/rXMxk34XPTP6u4t13RLEZ6LoOTKOh3bwVF95K8MiuwjszRn80//oNG9LQt0A0mJKj+jg5rZejTr+Rvd+iAAk5YZuyPWcZKlvg8JzNjdCuoeDByjRCfdHyO+kj2RQli8ssejlhuBOmDQ6j9w20Q0vUPKIX8WeetEAmVJisyQX5EJs5CjNUyW6l71gB',
		/*refresh_token:*/ 'Ci47bzKOB7VTCC7bfx5umNngVUZwsMiCOsHkvAQnYfn4BuRHWqhrcv!aHd8qIsJ722M8vLWhzBPXvODWuYH!hpwNPX8sEHYKAKd5XK2hzP!6ysewFmSNwkqUZli8li!nIx6T*Rl!DP6gpQ5eu5pGKyqaNcI5Ah6l7KkvEd0Q3CjqF2Qqg9JDYCcLhYHB1xpEPLPUj1PlSjPbmkhSjQTlXuCsap4GV3ncUizhhUKlLiGxCHrmnCGe8IV17DNfLH4!IWm6x88XfoTIHYuYR01g8ecfyX0AMeuA113OGxLQmw3Y8YKLRAcP7N0r!BR2bw3somLVIY2Eg8pwUK4W0CjCFs72eUN8dOHj5n82FO0O2quaq6WXFRSTgFKnnGw3jo2HsLHsUfnObLc1q*yI0s30v*s$'
		);
describe('',function(){
	this.timeout(3500);
describe('Refresh Token', function() {
	describe('using dropbox',function(){
		it('should not return token',function(done){
			dropbox.auth.renewToken().then(function(renewData){
				renewData.should.not.have.property('access_token');
			}).then(done,done);
		});
	});

	describe('using onedrive',function(){
		it('should return a token',function(done){
			onedrive.auth.renewToken().then(function(renewData){
				renewData.should.have.property('access_token');
				if(renewData && !renewData.access_token){
					console.log(renewData);
				}
			}).then(done,done);
		});
	});

	describe('using google drive',function(){
		it('should return a token',function(done){
			googledrive.auth.renewToken().then(function(renewData){
				renewData.should.have.property('access_token');
			}).then(done,done);
		});
	});
});

describe.skip('Account Info', function() {
	describe('using dropbox',function(){
		it('should return transformed data',function(done){
			dropbox.info.accountInfo().then(function(data){
				data.should.be.ok;
				data.should.have.property('name');
				data.should.have.property('email');
				data.should.have.property('avatar_url');
				data.should.have.property('created_date');
				data.should.have.property('modified_date');
				data.should.have.property('id');
				data.should.have.property('_raw');
			}).then(done,done);
		});
	});

	describe('using onedrive',function(){
		it('should return transformed data',function(done){
			onedrive.info.accountInfo().then(function(data){
				data.should.be.ok;
				data.should.have.property('name');
				data.should.have.property('email');
				data.should.have.property('avatar_url');
				data.should.have.property('created_date');
				data.should.have.property('modified_date');
				data.should.have.property('id');
				data.should.have.property('_raw');
			}).then(done,done);
		});
	});

	describe('using google drive',function(){
		it('should return transformed data',function(done){
			googledrive.info.accountInfo().then(function(data){
				data.should.be.ok;
				data.should.have.property('name');
				data.should.have.property('email');
				data.should.have.property('avatar_url');
				data.should.have.property('created_date');
				data.should.have.property('modified_date');
				data.should.have.property('id');
				data.should.have.property('_raw');
			}).then(done,done);
		});
	});
});

describe.skip('Usage Qouta', function() {
	describe('using dropbox',function(){
		it('should return transformed data',function(done){
			dropbox.info.usageQouta().then(function(data){
				data.should.be.ok;
				data.should.have.property('total_bytes');
				data.should.have.property('used_bytes');
				data.should.have.property('_raw');
			}).then(done,done);
		});
	});

	describe('using onedrive',function(){
		it('should return transformed data',function(done){
			onedrive.info.usageQouta().then(function(data){
				data.should.be.ok;
				data.should.have.property('total_bytes');
				data.should.have.property('used_bytes');
				data.should.have.property('_raw');
			}).then(done,done);
		});
	});

	describe('using google drive',function(){
		it('should return transformed data',function(done){
			googledrive.info.usageQouta().then(function(data){
				data.should.be.ok;
				data.should.have.property('total_bytes');
				data.should.have.property('used_bytes');
				data.should.have.property('_raw');
			}).then(done,done);
		});
	});
});

describe.skip('Listing file of',function(){
	describe('root folder with empty id',function(){
		describe('using dropbox',function(){
			it('should return a transformed data',function(done){
				dropbox.metadata.listFile().then(function(data){
					data.should.be.ok;
					data.should.have.property('content');
					data.content.should.be.array;
				}).then(done,done);
			});
		});
		describe('using onedrive',function(){
			it('should return a transformed data',function(done){
				onedrive.metadata.listFile().then(function(data){
					data.should.be.ok;
					data.should.have.property('content');
					data.content.should.be.array;
				}).then(done,done);
			});
		});
		describe('using google drive',function(){
			it('should return a transformed data',function(done){
				googledrive.metadata.listFile().then(function(data){
					data.should.be.ok;
					data.should.have.property('content');
					data.content.should.be.array;
				}).then(done,done);
			});
		});
	});

	describe('folder with id',function(){
		describe('using dropbox',function(){
			it('should return a transformed data',function(done){
				dropbox.metadata.listFile('/c++').then(function(data){
					data.should.be.ok;
					data.success.should.equal(true);
					data.should.have.property('content');
					data.content.should.be.array;
				}).then(done,done);
			});
		});
		describe('using onedrive',function(){
			it('should return a transformed data',function(done){
				onedrive.metadata.listFile('folder.e0de0102ecb2448c.E0DE0102ECB2448C!106').then(function(data){
					data.should.be.ok;
					data.success.should.equal(true);
					data.should.have.property('content');
					data.content.should.be.array;
				}).then(done,done);
			});
		});
		describe('using google drive',function(){
			it('should return a transformed data',function(done){
				googledrive.metadata.listFile('0AOc3nh6wFb5CUk9PVA').then(function(data){
					data.should.be.ok;
					data.success.should.equal(true);
					data.should.have.property('content');
					data.content.should.be.array;
				}).then(done,done);
			});
		});
	});

	describe('not exist folder',function(){
		describe('using dropbox',function(){
			it('should return a 404 error',function(done){
				dropbox.metadata.listFile('dfrdhttr').then(function(data){
					data.should.be.ok;
					data.success.should.equal(false);
					data.error_code.should.equal(404);
				}).then(done,done);
			});
		});
		describe('using onedrive',function(){
			it('should return a 400 error (unsupport id)',function(done){
				onedrive.metadata.listFile('dfrdhttr').then(function(data){
					data.should.be.ok;
					data.success.should.equal(false);
					data.error_code.should.equal(400);
				}).then(done,done);
			});
			it('should return a 404 error (non exist id)',function(done){
				onedrive.metadata.listFile('folder.e0de0102ecb2448c.E0DE0002ECB2448C!106').then(function(data){
					data.should.be.ok;
					data.success.should.equal(false);
					data.error_code.should.equal(404);
				}).then(done,done);
			});
		});
		describe('using google drive',function(){
			it('should return a 404 error',function(done){
				googledrive.metadata.listFile('dfrdhttr').then(function(data){
					data.should.be.ok;
					data.success.should.equal(false);
					data.error_code.should.equal(404);
				}).then(done,done);
			});
		});
	});
});

describe.skip('Getting metadata of',function(){
	describe('root folder with empty id',function(){
		describe('using dropbox',function(){
			it('should return a transformed data',function(done){
				dropbox.metadata.get().then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(false);
					data.is_folder.should.equal(true);
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
		describe('using onedrive',function(){
			it('should return a transformed data',function(done){
				onedrive.metadata.get().then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(false);
					data.is_folder.should.equal(true);
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
		describe('using google drive',function(){
			it('should return a transformed data',function(done){
				googledrive.metadata.get().then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(false);
					data.is_folder.should.equal(true);
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
	});

	describe('folder with id',function(){
		describe('using dropbox',function(){
			it('should return a transformed data',function(done){
				dropbox.metadata.get('/c++').then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(false);
					data.is_folder.should.equal(true);
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
		describe('using onedrive',function(){
			it('should return a transformed data',function(done){
				onedrive.metadata.get('folder.e0de0102ecb2448c.E0DE0102ECB2448C!106').then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(false);
					data.is_folder.should.equal(true);
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
		describe('using google drive',function(){
			it('should return a transformed data',function(done){
				googledrive.metadata.get('0AOc3nh6wFb5CUk9PVA').then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(false);
					data.is_folder.should.equal(true);
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
	});

	describe('file with id',function(){
		describe('using dropbox',function(){
			it('should return a transformed data',function(done){
				dropbox.metadata.get('/CTNET.jpg').then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(true);
					data.is_folder.should.equal(false);
					//data.etag.should.be.ok;
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
		describe('using onedrive',function(){
			it('should return a transformed data',function(done){
				onedrive.metadata.get('file.e0de0102ecb2448c.E0DE0102ECB2448C!572').then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(true);
					data.is_folder.should.equal(false);
					//data.etag.should.be.ok;
					data.should.have.property('etag');
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
		describe('using google drive',function(){
			it('should return a transformed data',function(done){
				googledrive.metadata.get('0B-c3nh6wFb5Ccm56Ui15Z3RWTlk').then(function(data){
					data.should.be.ok;
					data.is_file.should.equal(true);
					data.is_folder.should.equal(false);
					//data.etag.should.be.ok;
					data.should.have.property('identifier');
					data.should.have.property('parent_identifier');
					data.should.have.property('created_date');
					data.should.have.property('modified_date');
					data.should.have.property('name');
					data.should.have.property('description');
					data.should.have.property('_raw');
				}).then(done,done);
			});
		});
	});

	describe('not exist file',function(){
		describe('using dropbox',function(){
			it('should return a 404 error',function(done){
				dropbox.metadata.get('/tafidje').then(function(data){
					data.should.be.ok;
					data.success.should.equal(false);
					data.error_code.should.equal(404);
				}).then(done,done);
			});
		});
		describe('using onedrive',function(){
			it('should return a 404 error',function(done){
				onedrive.metadata.get('file.e0de0102ecb2448c.E0DE0002ECB2448C!572').then(function(data){
					data.should.be.ok;
					data.success.should.equal(false);
					data.error_code.should.equal(404);
				}).then(done,done);
			});
		});
		describe('using google drive',function(){
			it('should return a 404 error',function(done){
				googledrive.metadata.get('0B-c3nh6wFbsdf556Ui15Z3RWTlk').then(function(data){
					data.should.be.ok;
					data.success.should.equal(false);
					data.error_code.should.equal(404);
				}).then(done,done);
			});
		});
	});

});
});